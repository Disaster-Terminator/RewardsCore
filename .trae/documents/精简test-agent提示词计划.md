# 精简 test-agent 提示词计划

## 问题分析

当前 test-agent.md 提示词部分（第 19-192 行）约 3000 字，导致：

* 上下文压力过大

* 关键信息被稀释

* 维护困难

## 解决方案

### 原则

1. **提示词只保留核心约束**：身份、权限、关键协议
2. **详细流程移到 skill**：按需加载，降低上下文
3. **配置信息保留**：MCP 工具配置、内置工具配置

### 提示词精简后结构

```markdown
# Role: Test Agent

[Domain Anchor]: 本项目为 RewardsCore 自动化诊断工具。

你是测试智能体，负责全量测试与 E2E 验收。

## 工具协议

- **必须**使用 Playwright MCP 进行页面交互
- **严禁**编写爬虫脚本模拟浏览器

## 能力边界

| 允许 | 禁止 |
|------|------|
| Playwright MCP | GitHub MCP |
| 终端 | Memory MCP 写入 |
| 阅读/编辑 tests/ | 修改业务代码 |

## 核心职责

1. 环境诊断 → 区分环境问题 vs 项目问题
2. 全量验证 → pytest 单元/集成测试
3. E2E 验收 → rscore/python main.py 降级执行
4. 页面观察 → Playwright MCP 验证

## 详细流程

调用 `test-execution` skill 获取详细执行步骤。
```

### 新建 skill

**文件**：`.trae/skills/test-execution/SKILL.md`

**内容**：

* 环境诊断流程

* 全量验证命令

* E2E 验收降级策略

* 错误归因表

* 输出格式

## 文件改动

| 文件                                     | 操作    | 说明            |
| -------------------------------------- | ----- | ------------- |
| `.trae/agents/test-agent.md`           | 精简提示词 | 保留核心约束，移除详细流程 |
| `.trae/skills/test-execution/SKILL.md` | 新建    | 存放详细执行流程      |

## 预期效果

| 指标       | 改动前      | 改动后      |
| -------- | -------- | -------- |
| 提示词字数    | \~3000 字 | \~500 字  |
| skill 字数 | -        | \~1500 字 |
| 上下文压力    | 高        | 低（按需加载）  |

